
Offensive Penetration Testing

* references: https://www.youtube.com/watch?v=WKmbIhH9Wv8

# Enumeration stages 
### Passive Reconassaince
- google the target.com
- twitter / other social media
- job postings
- visit company website as normal user
- wayback machine
- netcraft / DNS scans
- Whois lookups

### Active Reconassaince
- nmap (-sn) network scan / ARP scan / netdiscover
- detailed scan of target (TCP `-sT` or `-sS` / UDP `-sU` full scans)
- DNS check (dig / nslookup / attempt zone transfer)
- check each port (banner grabbing & advanced enum)


# Escalation
### Further Enumeration
- current user (Linux & Win: `whoami`)
- current user permissions (Linux: `id`, Win: `net user <USER>`)
- other users on system (Linux: `cat /etc/passwd`, `users`, Win: `net users`)
- check environment variables (Linux: `env`, Win: `Get-ChildItem -Path Env:`)
- view hostname (Linux & Win: `hostname`)
- standard system information (Linux: `uname -a`, `cat /etc/*-release`, `cat /etc/issue`, Win: `systeminfo`, Win (PS): `Get-CimInstance Win32_OperatingSystem | FL *` )
- running tasks (Linux: `ps aux` Win (cmd): `tasklist /svc`, (PS) `Get-Service`) 
  - Windows process commands do not display high privilege tas. 
  - Look for processes run by root that are connected to a binary with weak permissions)
- Network interface/adapter information (Linux: `ifconfig`, Win: `ipconfig /all`)
- System port information (Linux: `netstat -ano`, Win: `ss -anp`) 
  - look for services only available on loopback
- Routing table info (Linux: `routel`, Win: `route print`)
- Firewall rules (Linux: `iptables -t nat -L`, Win: `netsh advfirewall show currentprofile`, `netsh advfirewall firewall show rule name=all` )
  - important to check if using as a pivot point / port forwarding point
  - linux firewall iptables rule requires privileged account
- Enumerating scheduled tasks (Linux: `ls -lhsa /etc/cron*`, Win: `schtasks /query  /fo LIST /v`)
  - systems such as servers executes scheduled tasks
  - attempt to modify misconfigured privileged tasks (e.g weak permissions)
  - checked Windows "Task to Run" file for weak permissions in order to manipulate before task is run
  - admins add their own tasks to crontab which may be misconfigured `cat /etc/crontab`
- Enumerating installed software / patch levels (Linux: `dpkg -l`, Win: `wmic product get name,version,vendor`)
  - only apps installed with windows installer will be displayed
  - on Linux, it depends on distro (done with package managers)
  - check for vulnerable version of apps for privesc
- Check readable/writable files + directories (Linux: `file / -writable -type f,d 2>/dev/null`, Win (PS): `Get-ChildItem "C:\Program Files" -Recurse | Get-Acl | ?($_.AccessToString -match "Everyone\sAllow\s\sModify")`, (cmd) `accesschk.exe -uws 'Everyone' 'C:\Program Files'`)
  - admins may have misconfigured directories
  - the `Get-Acl` cmdlet may not run recursively, so it is piped into `Get-ChildItem`
- Enumerating Device Drivers & Kernel Modules (Linux: `lsmod`, `/sbin/modinfo <MODULE>`, Win: `/`)
- Checking for SUID bit (Linux: `find / -perm -u=s -type f 2>/dev/null`, Win: `reg query HKLM\Software\Policies\Microsoft\Windows\Installer`)
  - SUID binary runs under context as owner regardless of user
  - on Windows, if value is 1, then all applications can run under context of privileged account
  - find 